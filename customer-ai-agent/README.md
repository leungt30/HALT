# Customer AI Agent Service

This service runs an automated AI agent that simulates human customer behavior on the HALT frontend. It uses browser automation (`browser-use` + `playwright`) to browse, scroll, add items to cart, and provide feedback.

## ðŸš€ Getting Started

### Prerequisites

- Python 3.11+
- Virtual Environment with dependencies installed (see root `runbook.md`)
- `GOOGLE_API_KEY` set in `.env`

### Running the Service

Navigate to this directory and run the server:

```bash
cd customer-ai-agent
../.venv/bin/python server.py
# Server will start on http://0.0.0.0:8000
```

## ðŸ“¡ API Reference

### Trigger Simulation

Triggers a new browser agent session. The agent will pick a random persona (or use the override), perform actions on the site, and return a summary of its experience.

- **Endpoint**: `POST /simulate`
- **Content-Type**: `application/json`

#### Request Body

| Field | Type | Required | Description |
| :--- | :--- | :--- | :--- |
| `persona_override` | `string` | No | Name of a specific persona to simulate (e.g., "Harold Nguyen"). If omitted, a random persona is chosen. |

#### Example Request

**Random Persona:**
```bash
curl -X POST http://localhost:8000/simulate \
  -H "Content-Type: application/json" \
  -d '{}'
```

**Specific Persona:**
```bash
curl -X POST http://localhost:8000/simulate \
  -H "Content-Type: application/json" \
  -d '{ "persona_override": "Renee Whitaker" }'
```

#### Response

Returns a JSON object containing the execution status and the feedback provided by the "customer".

```json
{
  "status": "completed",
  "persona": "Renee Whitaker",
  "feedback": {
    "user_satisfaction": "8",
    "primary_friction_point": "No search bar found.",
    "liked_features": ["Clean layout", "Fast loading"],
    "reason_for_exit": "Goal completed."
  }
}
```

> **Note**: The `feedback` field is a JSON-formatted string generated by the AI agent at the end of its session.

## ðŸ›  Project Structure

- `server.py`: FastAPI application entry point.
- `agent_logic.py`: Service adapter calling the simulation logic.
- `main.py`: Core simulation logic using `browser-use`.
- `personas.json`: Database of user profiles used for simulation.
